<!DOCTYPE html>
<html lang="fr-FR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AREP DIFFUSION</title>

    <!-- Add the link to the SCSS style sheet -->
    <link rel="stylesheet" href="styles.css">

    <!-- Font Awesome CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" integrity="sha512-VFMgtYsbkEX9PC0Q/3M3N15zkNxdMKvyB11EyuAVv3xj3tx8e7LKX6yKU4sjo8PVnrDUEBy9QaQZayQEXbbKGg==" crossorigin="anonymous" />

    <!-- React CDN links -->
    <script crossorigin src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>

    <!-- Babel for JSX/React -->
    <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

    <!-- Leaflet JavaScript -->
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

    <!-- DATA -->
    <script src="./data/bordeaux_iso_20min.js"></script>

    <!-- COMPONENTS -->
    <script type="text/babel">

    // Navigation.js
    const Navigation = () => {
        return (
            <nav>
                <div className="logo">
                    <img src="img/logo_arep.png" alt="AREP" />
                </div>
                <ul className="menu">
                    <li><a href="">ACCUEIL</a></li>
                    <li><a href="#">EQUIPE</a></li>
                    <li><a href="#">SOURCES</a></li>
                </ul>
            </nav>
        );
    }

    //LEAFLET
    const LeafletMap = () => {
        React.useEffect(() => {
            // Create a Leaflet map centered at [0, 0] with zoom level 2
            const map = L.map('map', { scrollWheelZoom:false });
                // .setView([44.82548830107521, -0.5563682436017133], 12);


            // Add a tile layer using CDN links
            L.tileLayer('https://tiles.stadiamaps.com/tiles/alidade_smooth/{z}/{x}/{y}{r}.png?&api_key=a31200ab-bc94-4e77-b6d9-87fb29b52314').addTo(map);

            //GEOJSON FROM DATA
            var geojson_bordeaux = L.geoJSON(bordeaux_iso_20min, {  }).addTo(map);
            map.fitBounds(geojson_bordeaux.getBounds());
            map.setZoom(12);

            return () => {
                // Clean up the map when the component is unmounted
                map.remove();
            };
        }, []); // Empty dependency array ensures this effect runs once when the component mounts
        
        return (
            <div className='LeafletMap'>
                <div className="LeafletMap-arrow"> 	&#x3008; </div>
                <div id="map" style={{ height: '500px', width: '500px', borderRadius: '50%', margin:'0 auto' }}></div>
                <div className="LeafletMap-arrow"> 	&#x3009; </div>
            </div>
        );
    }

    //SEARCH
    const SearchBar = ({ onSearch }) => {
        const [query, setQuery] = React.useState('');

        const handleInputChange = (e) => {
            setQuery(e.target.value);
            if(e.target.value.length > 2) onSearch(query);
        };

        const handleSearch = () => {
            // Pass the search query to the parent component
            // onSearch(query);
        };

        return (
            <div className="search-bar">
                <input
                    type="text"
                    placeholder="Trouver une gare..."
                    value={query}
                    onChange={handleInputChange}
                />
                {/*<button onClick={handleSearch}>Search</button>*/}
            </div>
        );
    };
    
    //LIST OF ELEMENT IN LINE
    const InlineList = ({ items }) => {
        return (
            <div className="inline-list">
                {items.map((item, index) => (
                    <div key={index} className="list-item">
                        {/*item*/}
                        <ElementWithImageAndText
                            key={index}
                            imageUrl={item.imageUrl}
                            text={item.text}
                        />
                    </div>
                ))}
            </div>
        );
    }

    //ELEMENT
    const ElementWithImageAndText = ({ imageUrl, text }) => {
        return (
            <div className="element-with-image-and-text">
                <img src={imageUrl} alt="Element Image" className="element-image" />
                <p className="element-text">{text}</p>
            </div>
        );
    }

    </script>

    <!-- Your React components will be placed in the following script tag -->
    <script type="text/babel">

        const App = () => {
            const items = [
                { imageUrl: './img/world_map.png', text: 'Gare de ...1' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...2' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...3' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...4' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...5' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...6' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...7' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...8' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...9' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...10' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...11' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...12' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...13' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...14' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...15' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...16' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...17' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...18' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...19' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...20' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...21' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...22' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...23' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...24' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...25' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...26' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...27' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...28' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...29' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...30' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...31' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...32' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...33' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...34' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...35' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...36' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...37' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...38' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...39' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...40' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...41' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...42' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...43' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...44' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...45' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...46' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...47' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...48' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...49' },
                { imageUrl: './img/world_map.png', text: 'Gare de ...50' },
            ];
            const handleSearch = (query) => {
                // Handle the search logic here (e.g., fetch data, filter results)
                console.log('Search Query:', query);
                console.log('DATA:', bordeaux_iso_20min);
            };
            
            return (
                <div id='main'>
                    <Navigation />
                    <LeafletMap />
                    <SearchBar onSearch={handleSearch} />
                    <InlineList items={items} />
                </div>
            );
        }

        // Render the React component
        ReactDOM.render(
            <App />,
            document.getElementById('root')
        );
    </script>
</head>
<body>

    <!-- The root div where React will be mounted -->
    <div id="root"></div>

</body>
</html>
